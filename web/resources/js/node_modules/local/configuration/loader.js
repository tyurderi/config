module.exports = require('classjs').define({
    properties:
    {
        configId: 'Integer',

        $container: 'Object',
        listingUrl: 'String',
        listingColumnsUrl: 'String'
    },
    constructor: function(configId)
    {
        var me = this;

        me.configId          = configId;
        me.$container        = $('.configuration--container');
        me.listingUrl        = me.$container.attr('data-listingUrl');
        me.listingColumnsUrl = me.$container.attr('data-listingColumnsUrl');
    },
    members:
    {
        load: function()
        {
            var me     = this,
                $table = (new (require('local/table')));

            me.$container.empty();
            $table.insert(me.$container);

            me._loadColumns(function(columns) {
                columns.forEach(function(column) {
                    $table.addColumn(column.name, column.label);
                });
            });
        },

        _loadColumns: function(callback)
        {
            var me = this;

            $.get(me.listingColumnsUrl, {id: me.configId}, function(response)
            {
                if(response.success)
                {
                    callback.apply(me, [response.data]);
                }
            });
        }
    }
});